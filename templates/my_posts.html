<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Posts - Autism Ally</title>
	<link rel="icon" type="Image/png" href="/static/images/aut.png" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/logout">Logout</a></li>
            </ul>
        </nav>
    </header>
    <div class="container">
        {% include 'sidebar.html' %}
        <div class="dashboard-container">
            <h1>My Posts</h1>
            <div class="main-content">
                <section id="posts">
                    {% for post in posts %}
                        <div class="post">
                            <h5>{{ post.title }} : {{ post.date_posted.strftime('%Y-%m-%d %H:%M:%S') }}</p></h5>
                            <p>{{ post.content }}</p>
							<button onclick="deletePost({{ post.id }})">Delete</button>
        					<button onclick="updatePost({{ post.id }})">Update</button>
                        </div>
                    {% endfor %}
                </section>
            </div>
        </div>
    </div>
	<script>
    function deletePost(postId) {
        fetch(`/posts/${postId}`, {
            method: 'DELETE'
        })
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                alert(data.error);
            } else {
                alert('Post deleted successfully');
                location.reload();
            }
        });
    }

    function updatePost(postId) {
        const title = prompt('Enter new title:');
        const content = prompt('Enter new content:');
        fetch(`/posts/${postId}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ title: title, content: content })
        })
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                alert(data.error);
            } else {
                alert('Post updated successfully');
                location.reload();
            }
        });
    }
</script>
</body>
</html>
